import { u as useState, a as __nuxt_component_0$1, _ as _export_sfc } from '../server.mjs';
import { useSSRContext, defineComponent, ref, withAsyncContext, unref, withCtx, createVNode, mergeProps } from 'vue';
import { ssrRenderClass, ssrRenderAttr, ssrRenderList, ssrInterpolate, ssrRenderComponent, ssrRenderAttrs } from 'vue/server-renderer';
import { u as useLazyAsyncData } from './asyncData.d6078788.mjs';
import 'ofetch';
import 'hookable';
import 'unctx';
import 'ufo';
import 'h3';
import '@unhead/vue';
import '@unhead/dom';
import 'vue-router';
import 'defu';
import '../../nitro/node-server.mjs';
import 'node-fetch-native/polyfill';
import 'http';
import 'https';
import 'destr';
import 'unenv/runtime/fetch/index';
import 'scule';
import 'ohash';
import 'unstorage';
import 'radix3';
import 'node:fs';
import 'node:url';
import 'pathe';

const _sfc_main$3 = {};
function _sfc_ssrRender$1(_ctx, _push, _parent, _attrs) {
  _push(`<svg${ssrRenderAttrs(mergeProps({
    class: "heart",
    version: "1.1",
    id: "Capa_1",
    xmlns: "http://www.w3.org/2000/svg",
    "xmlns:xlink": "http://www.w3.org/1999/xlink",
    x: "0px",
    y: "0px",
    viewBox: "0 0 471.701 471.701",
    style: { "enable-background": "new 0 0 471.701 471.701" },
    "xml:space": "preserve"
  }, _attrs))}><g><path d="M433.601,67.001c-24.7-24.7-57.4-38.2-92.3-38.2s-67.7,13.6-92.4,38.3l-12.9,12.9l-13.1-13.1
		c-24.7-24.7-57.6-38.4-92.5-38.4c-34.8,0-67.6,13.6-92.2,38.2c-24.7,24.7-38.3,57.5-38.2,92.4c0,34.9,13.7,67.6,38.4,92.3
		l187.8,187.8c2.6,2.6,6.1,4,9.5,4c3.4,0,6.9-1.3,9.5-3.9l188.2-187.5c24.7-24.7,38.3-57.5,38.3-92.4
		C471.801,124.501,458.301,91.701,433.601,67.001z M414.401,232.701l-178.7,178l-178.3-178.3c-19.6-19.6-30.4-45.6-30.4-73.3
		s10.7-53.7,30.3-73.2c19.5-19.5,45.5-30.3,73.1-30.3c27.7,0,53.8,10.8,73.4,30.4l22.6,22.6c5.3,5.3,13.8,5.3,19.1,0l22.4-22.4
		c19.6-19.6,45.7-30.4,73.3-30.4c27.6,0,53.6,10.8,73.2,30.3c19.6,19.6,30.3,45.6,30.3,73.3
		C444.801,187.101,434.001,213.101,414.401,232.701z"></path></g></svg>`);
}
const _sfc_setup$3 = _sfc_main$3.setup;
_sfc_main$3.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("components/Heart.vue");
  return _sfc_setup$3 ? _sfc_setup$3(props, ctx) : void 0;
};
const __nuxt_component_0 = /* @__PURE__ */ _export_sfc(_sfc_main$3, [["ssrRender", _sfc_ssrRender$1]]);
const _sfc_main$2 = {};
function _sfc_ssrRender(_ctx, _push, _parent, _attrs) {
  _push(`<svg${ssrRenderAttrs(mergeProps({
    class: "heart",
    version: "1.1",
    id: "Capa_1",
    xmlns: "http://www.w3.org/2000/svg",
    "xmlns:xlink": "http://www.w3.org/1999/xlink",
    x: "0px",
    y: "0px",
    viewBox: "0 0 302.489 302.489",
    style: { "enable-background": "new 0 0 302.489 302.489" },
    "xml:space": "preserve"
  }, _attrs))}><path d="M302.351,98.012c-1.116-20.846-9.942-40.422-24.855-55.122c-15.103-14.887-34.811-23.086-55.491-23.086
	c-30.776,0-53.082,24.334-65.065,37.408c-1.85,2.019-4.018,4.384-5.527,5.827c-1.208-1.25-2.845-3.114-4.351-4.828
	c-10.944-12.466-33.72-38.406-66.571-38.406c-20.68,0-40.387,8.199-55.49,23.086C10.087,57.59,1.259,77.165,0.143,98.012
	c-1.111,20.812,4.212,38.921,17.26,58.72c10.324,15.669,37.545,46.266,66.195,74.408c14.757,14.495,28.339,26.779,39.277,35.524
	c17.762,14.2,24.565,16.021,28.506,16.021c3.695,0,10.683-1.657,28.615-15.981c10.913-8.717,24.448-20.982,39.143-35.468
	c28.393-27.99,55.515-58.628,65.956-74.507C293.877,143.372,303.774,124.629,302.351,98.012z"></path></svg>`);
}
const _sfc_setup$2 = _sfc_main$2.setup;
_sfc_main$2.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("components/HeartFavorite.vue");
  return _sfc_setup$2 ? _sfc_setup$2(props, ctx) : void 0;
};
const __nuxt_component_1 = /* @__PURE__ */ _export_sfc(_sfc_main$2, [["ssrRender", _sfc_ssrRender]]);
const _sfc_main$1 = /* @__PURE__ */ defineComponent({
  __name: "PokemonCard",
  __ssrInlineRender: true,
  props: {
    pokemon: null
  },
  emits: ["favoriteHasClicked", "unfavoriteHasClicked"],
  setup(__props, { emit }) {
    const { pokemon } = __props;
    const favoriteHasClicked = async (event) => {
      event.preventDefault();
      emit("favoriteHasClicked", pokemon.id);
    };
    const unfavoriteHasClicked = async (event) => {
      event.preventDefault();
      emit("unfavoriteHasClicked", pokemon.id);
    };
    return (_ctx, _push, _parent, _attrs) => {
      const _component_Heart = __nuxt_component_0;
      const _component_HeartFavorite = __nuxt_component_1;
      _push(`<div${ssrRenderAttrs(mergeProps({ class: "card" }, _attrs))}><div class="card__image"><img${ssrRenderAttr("src", __props.pokemon.image)}${ssrRenderAttr("alt", __props.pokemon.name)}></div><div class="card__footer"><div><h2 class="card__title">${ssrInterpolate(__props.pokemon.name)}</h2>`);
      if (__props.pokemon.types) {
        _push(`<span class="card__types">${ssrInterpolate(__props.pokemon.types.join(", "))}</span>`);
      } else {
        _push(`<!---->`);
      }
      _push(`</div>`);
      if (!__props.pokemon.isFavorite) {
        _push(ssrRenderComponent(_component_Heart, { onClick: favoriteHasClicked }, null, _parent));
      } else {
        _push(`<!---->`);
      }
      if (__props.pokemon.isFavorite) {
        _push(ssrRenderComponent(_component_HeartFavorite, { onClick: unfavoriteHasClicked }, null, _parent));
      } else {
        _push(`<!---->`);
      }
      _push(`</div></div>`);
    };
  }
});
const _sfc_setup$1 = _sfc_main$1.setup;
_sfc_main$1.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("components/PokemonCard.vue");
  return _sfc_setup$1 ? _sfc_setup$1(props, ctx) : void 0;
};
const URL_API = `https://q-exercise-api.o64ixruq9hj.us-south.codeengine.appdomain.cloud/api/rest`;
const getPokemons = async ({
  limit,
  offset,
  search,
  isFavorite,
  type
}) => {
  const url = new URL(`${URL_API}/pokemon`);
  if (limit) {
    url.searchParams.append("limit", String(limit));
  }
  if (offset) {
    url.searchParams.append("offset", String(offset));
  }
  if (search) {
    url.searchParams.append("search", search);
  }
  if (type) {
    url.searchParams.append("type", type);
  }
  if (isFavorite) {
    url.searchParams.append("isFavorite", String(isFavorite));
  }
  const data = await $fetch(url.href);
  return data;
};
const getPokemonsTypes = async () => {
  const data = await $fetch(`${URL_API}/pokemon-types`);
  return data;
};
const postPokemonFavorite = async (id) => {
  const data = await $fetch(`${URL_API}/pokemon/${id}/favorite`, {
    method: "POST"
  });
  return data;
};
const postPokemonUnFavorite = async (id) => {
  const data = await $fetch(`${URL_API}/pokemon/${id}/unfavorite`, {
    method: "POST"
  });
  return data;
};
const _sfc_main = /* @__PURE__ */ defineComponent({
  __name: "index",
  __ssrInlineRender: true,
  async setup(__props) {
    let __temp, __restore;
    const pokemonsCache = useState(() => [], "$pqtWcjQkdb");
    const pokemonsCount = useState("$cmRBlMwAGX");
    const queryParams = ref({
      limit: 20,
      offset: 0,
      search: "",
      isFavorite: false,
      type: ""
    });
    const {
      pending,
      data: pokemons,
      refresh
    } = ([__temp, __restore] = withAsyncContext(async () => useLazyAsyncData("pokemon-list", async () => {
      var _a;
      const response = await getPokemons({
        ...queryParams.value,
        search: (_a = queryParams.value.search) == null ? void 0 : _a.toLowerCase()
      });
      pokemonsCount.value = response.count;
      pokemonsCache.value = [...pokemonsCache.value, ...response.items];
      return pokemonsCache.value;
    })), __temp = await __temp, __restore(), __temp);
    const { data: pokemonsTypes } = ([__temp, __restore] = withAsyncContext(async () => useLazyAsyncData(
      "pokemons-types",
      async () => {
        const response = await getPokemonsTypes();
        return response;
      }
    )), __temp = await __temp, __restore(), __temp);
    const favoriteHasClicked = async (pokemonId) => {
      await postPokemonFavorite(pokemonId);
      const currentPokemon = pokemonsCache.value.find(
        (pokemon) => pokemon.id === pokemonId
      );
      currentPokemon.isFavorite = true;
    };
    const unfavoriteHasClicked = async (pokemonId) => {
      await postPokemonUnFavorite(pokemonId);
      const currentPokemon = pokemonsCache.value.find(
        (pokemon) => pokemon.id === pokemonId
      );
      currentPokemon.isFavorite = false;
    };
    return (_ctx, _push, _parent, _attrs) => {
      const _component_NuxtLink = __nuxt_component_0$1;
      const _component_PokemonCard = _sfc_main$1;
      _push(`<!--[--><div><div class="filters__favorites"><button class="${ssrRenderClass([{
        active: !unref(queryParams).isFavorite
      }, "filter__all"])}"> All </button><button class="${ssrRenderClass([{
        active: unref(queryParams).isFavorite
      }, "filter__favorites"])}"> Favorites </button></div></div><div class="type-favorites"><input class="filter__search" placeholder="Search" type="search" id="name" name="name"><div class="select"><select name="types" id="types" class="filter__select"><option${ssrRenderAttr("value", "")}>Type</option><!--[-->`);
      ssrRenderList(unref(pokemonsTypes), (type, index) => {
        _push(`<option${ssrRenderAttr("value", type)}>${ssrInterpolate(type)}</option>`);
      });
      _push(`<!--]--></select></div></div>`);
      if (unref(pokemons)) {
        _push(`<ul class="list"><!--[-->`);
        ssrRenderList(unref(pokemons), (pokemon) => {
          _push(`<li>`);
          _push(ssrRenderComponent(_component_NuxtLink, {
            to: `/pokemon/${pokemon.id}`
          }, {
            default: withCtx((_, _push2, _parent2, _scopeId) => {
              if (_push2) {
                _push2(ssrRenderComponent(_component_PokemonCard, {
                  pokemon,
                  onFavoriteHasClicked: favoriteHasClicked,
                  onUnfavoriteHasClicked: unfavoriteHasClicked
                }, null, _parent2, _scopeId));
              } else {
                return [
                  createVNode(_component_PokemonCard, {
                    pokemon,
                    onFavoriteHasClicked: favoriteHasClicked,
                    onUnfavoriteHasClicked: unfavoriteHasClicked
                  }, null, 8, ["pokemon"])
                ];
              }
            }),
            _: 2
          }, _parent));
          _push(`</li>`);
        });
        _push(`<!--]--></ul>`);
      } else {
        _push(`<!---->`);
      }
      if (unref(pokemonsCache).length <= unref(pokemonsCount) - 1) {
        _push(`<button class="button"> More pokemons </button>`);
      } else {
        _push(`<!---->`);
      }
      _push(`<!--]-->`);
    };
  }
});
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("pages/index.vue");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};

export { _sfc_main as default };
//# sourceMappingURL=index.019d5316.mjs.map
